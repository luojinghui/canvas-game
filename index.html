<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="initial-scale=1, width=device-width, maximum-scale=1, user-scalable=no">
    <link rel="stylesheet" href="./main.css"/>
</head>
<body>
<div>
    <!--题目描述： 实现一个在浏览器中运行的拼图游戏-->

    <!--1.可以从本机加载一幅图片，打散成若干小块，游戏者可以通过鼠标拖拽小块完成最终的拼图。-->
    <!--2.拼图的块数可以自由指定，最终用户可以选择拼图的难度，随意指定分成 m 行 n 列。-->
    <!--3.打散后的矩形块将会随机旋转一个角度，旋转角度仅考虑 90 °的倍数，比如说 0 °， 90°， 180°， 270°，以增加游戏的难度。-->
    <!--题目要求：-->

    <!--1.能够支持WebKit内核和另外任意一种非WebKit内核的浏览器。-->
    <!--2.不使用任何三方JavaScript类库，包括，但不限于jQuery。-->
    <!--3.不推荐界面元素使用绝对布局。-->
    <!--4.界面美观。-->
</div>
<div class="container">
    <h2 class="center mb10">拼图游戏</h2>
    <p class="desc center">游戏玩法:拖动图片到另一位置,即可交换图片,所有图片拼好即成功</p>
    <div class="flex a-c-c media">
        <div class="left-box">
            <div class="flex a-c-c step">
                <p class="mr10">步骤一:</p>
                <div class="flex1">
                    <div class="label">
                        <input type="text" id="m" placeholder="填写行数,默认3"/>
                    </div>
                    <div class="label">
                        <input type="text" id="n" placeholder="填写列数,默认3"/>
                    </div>
                </div>
            </div>
            <div class="flex a-c-c step">
                <p class="mr10">步骤二:</p>
                <div class="upload flex1">
                    <div class="upload-btn flex a-c-c j-c-c">上传图片</div>
                    <input type="file" id="imgPath" onchange="preview(this)"/>
                </div>
            </div>
            <div class="flex a-c-c step">
                <p class="mr10">步骤三:</p>
                <div class="flex1">
                    <div id="play" class="flex a-c-c j-c-c">Play Game</div>
                </div>
            </div>
        </div>

        <div class="right-box">
            <div id="game"></div>
        </div>
    </div>
</div>
<canvas id="canvas">cannot support canvas</canvas>

<div class="model hide" id="model">
    <div>
        <p>恭喜你,挑战成功！</p>
    </div>
</div>

<script src="./index.js"></script>
<script>
    function preview(file) {
        if (file.files && file.files[0]) {
            var reader = new FileReader();
            reader.onload = function (evt) {
                document.getElementById('game').innerHTML = "";
                var gridRow = document.getElementById("m").value || 3;
                var gridCol = document.getElementById("n").value || 3;

                if (parseInt(gridRow) <= 1 || parseInt(gridCol) <= 1) {
                    alert("太菜了,拒绝给你玩耍");

                    return;
                }

                puzzle.init(evt.target.result, gridRow, gridCol);
            };
            reader.readAsDataURL(file.files[0]);
        }
    }

    puzzle.init("./test.jpg", 3, 3);
</script>
</body>
</html>